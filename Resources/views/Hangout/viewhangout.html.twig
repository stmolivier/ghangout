{# we dont need to show the menu here #}
{% extends "ClarolineCoreBundle::base.html.twig" %}

{% block layout %}
<h3>SimUSante Hangout App</h3>
<p>
    <input class="button" type="button" value="Show participants!" id="showParticipants"
           style="visibility:hidden;"
           onClick="showParticipants()"/>
</p>
<div id="participantsDiv"></div>
{% endblock %}

{% block javascripts %}
    {# these two first js are mandatory to start a hangout #}
    <script type="text/javascript" src="https://hangoutsapi.talkgadget.google.com/talkgadget/apps/gadgets/js/rpc.js"></script>
    <script type="text/javascript" src="https://hangoutsapi.talkgadget.google.com/hangouts/api/hangout.js?v=1.4"></script>

    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="https://apis.google.com/js/client.js?onload=onClientReady"></script>

    {# custom js for the Hangout. we do stuff there #}
    <script>
    function showParticipants() {
        var participants = gapi.hangout.getParticipants();
        var retVal = '<p>Participants: </p><ul>';
        for (var index in participants) {
            var participant = participants[index];
            if (!participant.person) {
                retVal += '<li>A participant not running this app</li>';
            }
            retVal += '<li>' + participant.person.displayName + '</li>';
        }
        retVal += '</ul>';
        var div = document.getElementById('participantsDiv');
        div.innerHTML = retVal;
    }
    function init() {
        // When API is ready...
        gapi.hangout.onApiReady.add(
                function(eventObj) {
                    document.getElementById('showParticipants').style.visibility = 'visible';
                }
        );
    }
    // Add startup listener immediately.  If you need an
    // OAuth 2.0 access token, your startup will be different.
    init();
    </script>
{% endblock %}